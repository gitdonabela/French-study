<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alter Ego Ê≥ïËØ≠Âç°ÁâáÂ§ç‰π†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* ËÆæÁΩÆÈ°µÈù¢ */
        .setup-screen {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        .setup-card {
            background: white;
            border-radius: 24px;
            padding: 48px;
            max-width: 400px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
        }

        .setup-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }

        .setup-card h1 {
            font-size: 28px;
            margin-bottom: 12px;
            color: #333;
        }

        .setup-card p {
            color: #666;
            margin-bottom: 32px;
        }

        .setup-input {
            width: 100%;
            padding: 16px;
            font-size: 18px;
            border: 2px solid #c084fc;
            border-radius: 12px;
            margin-bottom: 24px;
            outline: none;
            transition: all 0.3s;
        }

        .setup-input:focus {
            border-color: #a855f7;
        }

        .setup-button {
            width: 100%;
            padding: 16px;
            font-size: 18px;
            font-weight: bold;
            background: linear-gradient(135deg, #9333ea, #ec4899);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .setup-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(147, 51, 234, 0.4);
        }

        .setup-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* ‰∏ªÂ∫îÁî® */
        .main-app {
            display: none;
        }

        /* Áä∂ÊÄÅÊ†è */
        .status-bar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .avatar {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #9333ea, #ec4899);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            font-weight: bold;
        }

        .user-details h2 {
            font-size: 18px;
            margin-bottom: 4px;
        }

        .user-details p {
            color: #666;
            font-size: 14px;
        }

        .trophy-info {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 18px;
            font-weight: bold;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e5e7eb;
            border-radius: 999px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #34d399, #3b82f6);
            transition: width 0.5s;
        }

        /* Ê®°ÂºèÂàáÊç¢ */
        .mode-switch {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
        }

        .mode-button {
            flex: 1;
            padding: 16px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.5);
            color: white;
        }

        .mode-button.active {
            background: white;
            color: #9333ea;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        /* Âç°ÁâáÂÆπÂô® */
        .card-container {
            perspective: 1000px;
            margin-bottom: 24px;
            min-height: 400px;
        }

        .card {
            position: relative;
            width: 100%;
            min-height: 400px;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            cursor: pointer;
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            min-height: 400px;
            backface-visibility: hidden;
            border-radius: 24px;
            padding: 48px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .card-front {
            background: white;
        }

        .card-back {
            background: linear-gradient(135deg, #9333ea, #ec4899);
            transform: rotateY(180deg);
        }

        .word-type {
            display: inline-block;
            padding: 8px 16px;
            background: #ede9fe;
            color: #9333ea;
            border-radius: 999px;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 24px;
        }

        .card-text {
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 16px;
            text-align: center;
        }

        .card-front .card-text {
            color: #1f2937;
        }

        .card-back .card-text {
            color: white;
        }

        .card-hint {
            font-size: 18px;
            color: #9ca3af;
        }

        .card-back .card-hint {
            color: rgba(255, 255, 255, 0.7);
        }

        .mastered-badge {
            margin-top: 16px;
            padding: 8px 16px;
            background: #d1fae5;
            color: #059669;
            border-radius: 999px;
            font-size: 14px;
            font-weight: bold;
        }

        /* ÊéßÂà∂ÊåâÈíÆ */
        .controls {
            display: flex;
            gap: 16px;
            align-items: center;
            justify-content: center;
            margin-bottom: 16px;
        }

        .control-button {
            width: 56px;
            height: 56px;
            background: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .control-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .master-button {
            padding: 16px 32px;
            font-size: 16px;
            font-weight: bold;
            background: white;
            color: #1f2937;
            border: none;
            border-radius: 999px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }

        .master-button.mastered {
            background: #10b981;
            color: white;
        }

        .master-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .card-counter {
            text-align: center;
            color: white;
            font-size: 18px;
            font-weight: bold;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <!-- ËÆæÁΩÆÈ°µÈù¢ -->
    <div id="setupScreen" class="setup-screen">
        <div class="setup-card">
            <div class="setup-icon">üë§</div>
            <h1>ÂàõÂª∫‰Ω†ÁöÑÊ≥ïËØ≠ÂàÜË∫´</h1>
            <p>Áªô‰Ω†ÁöÑÂ≠¶‰π†‰ºô‰º¥Ëµ∑‰∏™ÂêçÂ≠óÂêßÔºÅ</p>
            <input type="text" id="nameInput" class="setup-input" placeholder="ËæìÂÖ•‰Ω†ÁöÑÊ≥ïËØ≠ÂêçÂ≠ó..." />
            <button id="startButton" class="setup-button" disabled>ÂºÄÂßãÂ≠¶‰π†‰πãÊóÖ</button>
        </div>
    </div>

    <!-- ‰∏ªÂ∫îÁî® -->
    <div id="mainApp" class="main-app">
        <div class="container">
            <!-- Áä∂ÊÄÅÊ†è -->
            <div class="status-bar">
                <div class="status-header">
                    <div class="user-info">
                        <div class="avatar" id="avatar"></div>
                        <div class="user-details">
                            <h2 id="userName"></h2>
                            <p>Á≠âÁ∫ß <span id="userLevel">1</span> ¬∑ <span id="userPoints">0</span> ÂàÜ</p>
                        </div>
                    </div>
                    <div class="trophy-info">
                        <span>üèÜ</span>
                        <span id="masteredCount">0</span>/<span id="totalCount">110</span>
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
            </div>

            <!-- Ê®°ÂºèÂàáÊç¢ -->
            <div class="mode-switch">
                <button class="mode-button active" id="wordMode">üìö ÂçïËØçÂç°Áâá</button>
                <button class="mode-button" id="sentenceMode">üí¨ Âè•Â≠êÁªÉ‰π†</button>
            </div>

            <!-- Âç°Áâá -->
            <div class="card-container">
                <div class="card" id="card">
                    <div class="card-face card-front">
                        <div class="word-type" id="wordType"></div>
                        <div class="card-text" id="frontText"></div>
                        <div class="card-hint">ÁÇπÂáªÁøªËΩ¨Êü•Áúã‰∏≠Êñá</div>
                        <div class="mastered-badge hidden" id="masteredBadge">‚úì Â∑≤ÊéåÊè°</div>
                    </div>
                    <div class="card-face card-back">
                        <div class="card-text" id="backText"></div>
                        <div class="card-hint">ÁÇπÂáªËøîÂõûÊ≥ïËØ≠</div>
                    </div>
                </div>
            </div>

            <!-- ÊéßÂà∂ÊåâÈíÆ -->
            <div class="controls">
                <button class="control-button" id="prevButton">‚Üê</button>
                <button class="master-button" id="masterButton">Ê†áËÆ∞‰∏∫Â∑≤ÊéåÊè°</button>
                <button class="control-button" id="nextButton">‚Üí</button>
            </div>

            <div class="card-counter">
                <span id="currentIndex">1</span> / <span id="totalCards">100</span>
            </div>
        </div>
    </div>

    <script>
        // Êï∞ÊçÆ
        const words = [
            { french: "bonjour", chinese: "‰Ω†Â•Ω", type: "ÈóÆÂÄô" },
            { french: "merci", chinese: "Ë∞¢Ë∞¢", type: "Á§ºË≤åÁî®ËØ≠" },
            { french: "au revoir", chinese: "ÂÜçËßÅ", type: "ÂëäÂà´" },
            { french: "oui", chinese: "ÊòØ", type: "Âü∫Á°Ä" },
            { french: "non", chinese: "‰∏ç", type: "Âü∫Á°Ä" },
            { french: "s'il vous pla√Æt", chinese: "ËØ∑", type: "Á§ºË≤åÁî®ËØ≠" },
            { french: "excusez-moi", chinese: "ÂØπ‰∏çËµ∑/ÊâìÊâ∞‰∏Ä‰∏ã", type: "Á§ºË≤åÁî®ËØ≠" },
            { french: "pardon", chinese: "Êä±Ê≠â", type: "Á§ºË≤åÁî®ËØ≠" },
            { french: "je", chinese: "Êàë", type: "‰ª£ËØç" },
            { french: "tu", chinese: "‰Ω†(ÈùûÊ≠£Âºè)", type: "‰ª£ËØç" },
            { french: "il", chinese: "‰ªñ", type: "‰ª£ËØç" },
            { french: "elle", chinese: "Â•π", type: "‰ª£ËØç" },
            { french: "nous", chinese: "Êàë‰ª¨", type: "‰ª£ËØç" },
            { french: "vous", chinese: "ÊÇ®/‰Ω†‰ª¨", type: "‰ª£ËØç" },
            { french: "ils", chinese: "‰ªñ‰ª¨", type: "‰ª£ËØç" },
            { french: "elles", chinese: "Â•π‰ª¨", type: "‰ª£ËØç" },
            { french: "√™tre", chinese: "ÊòØ/Â≠òÂú®", type: "Âä®ËØç" },
            { french: "avoir", chinese: "Êúâ", type: "Âä®ËØç" },
            { french: "faire", chinese: "ÂÅö", type: "Âä®ËØç" },
            { french: "aller", chinese: "Âéª", type: "Âä®ËØç" },
            { french: "venir", chinese: "Êù•", type: "Âä®ËØç" },
            { french: "pouvoir", chinese: "ËÉΩÂ§ü", type: "Âä®ËØç" },
            { french: "vouloir", chinese: "ÊÉ≥Ë¶Å", type: "Âä®ËØç" },
            { french: "devoir", chinese: "ÂøÖÈ°ª", type: "Âä®ËØç" },
            { french: "savoir", chinese: "Áü•ÈÅì", type: "Âä®ËØç" },
            { french: "prendre", chinese: "Êãø/Âèñ", type: "Âä®ËØç" },
            { french: "manger", chinese: "ÂêÉ", type: "Âä®ËØç" },
            { french: "boire", chinese: "Âñù", type: "Âä®ËØç" },
            { french: "parler", chinese: "ËØ¥ËØù", type: "Âä®ËØç" },
            { french: "√©couter", chinese: "Âê¨", type: "Âä®ËØç" },
            { french: "regarder", chinese: "Áúã", type: "Âä®ËØç" },
            { french: "lire", chinese: "ÈòÖËØª", type: "Âä®ËØç" },
            { french: "√©crire", chinese: "ÂÜô", type: "Âä®ËØç" },
            { french: "aimer", chinese: "ÂñúÊ¨¢", type: "Âä®ËØç" },
            { french: "adorer", chinese: "ÁÉ≠Áà±", type: "Âä®ËØç" },
            { french: "d√©tester", chinese: "ËÆ®Âéå", type: "Âä®ËØç" },
            { french: "maison", chinese: "ÊàøÂ≠ê", type: "ÂêçËØç" },
            { french: "chat", chinese: "Áå´", type: "ÂêçËØç" },
            { french: "chien", chinese: "Áãó", type: "ÂêçËØç" },
            { french: "livre", chinese: "‰π¶", type: "ÂêçËØç" },
            { french: "table", chinese: "Ê°åÂ≠ê", type: "ÂêçËØç" },
            { french: "chaise", chinese: "Ê§ÖÂ≠ê", type: "ÂêçËØç" },
            { french: "porte", chinese: "Èó®", type: "ÂêçËØç" },
            { french: "fen√™tre", chinese: "Á™óÊà∑", type: "ÂêçËØç" },
            { french: "eau", chinese: "Ê∞¥", type: "ÂêçËØç" },
            { french: "pain", chinese: "Èù¢ÂåÖ", type: "ÂêçËØç" },
            { french: "caf√©", chinese: "ÂíñÂï°", type: "ÂêçËØç" },
            { french: "th√©", chinese: "Ëå∂", type: "ÂêçËØç" },
            { french: "lait", chinese: "ÁâõÂ•∂", type: "ÂêçËØç" },
            { french: "vin", chinese: "ÈÖí", type: "ÂêçËØç" },
            { french: "fromage", chinese: "Â•∂ÈÖ™", type: "ÂêçËØç" },
            { french: "pomme", chinese: "ËãπÊûú", type: "ÂêçËØç" },
            { french: "orange", chinese: "Ê©ôÂ≠ê", type: "ÂêçËØç" },
            { french: "banane", chinese: "È¶ôËïâ", type: "ÂêçËØç" },
            { french: "tomate", chinese: "Ë•øÁ∫¢Êüø", type: "ÂêçËØç" },
            { french: "salade", chinese: "Ê≤ôÊãâ", type: "ÂêçËØç" },
            { french: "viande", chinese: "ËÇâ", type: "ÂêçËØç" },
            { french: "poisson", chinese: "È±º", type: "ÂêçËØç" },
            { french: "poulet", chinese: "È∏°ËÇâ", type: "ÂêçËØç" },
            { french: "riz", chinese: "Á±≥È•≠", type: "ÂêçËØç" },
            { french: "p√¢tes", chinese: "ÊÑèÂ§ßÂà©Èù¢", type: "ÂêçËØç" },
            { french: "soupe", chinese: "Ê±§", type: "ÂêçËØç" },
            { french: "dessert", chinese: "ÁîúÁÇπ", type: "ÂêçËØç" },
            { french: "g√¢teau", chinese: "ËõãÁ≥ï", type: "ÂêçËØç" },
            { french: "glace", chinese: "ÂÜ∞Ê∑áÊ∑ã", type: "ÂêçËØç" },
            { french: "chocolat", chinese: "Â∑ßÂÖãÂäõ", type: "ÂêçËØç" },
            { french: "beau", chinese: "Áæé‰∏ΩÁöÑ(Èò≥ÊÄß)", type: "ÂΩ¢ÂÆπËØç" },
            { french: "belle", chinese: "Áæé‰∏ΩÁöÑ(Èò¥ÊÄß)", type: "ÂΩ¢ÂÆπËØç" },
            { french: "grand", chinese: "Â§ßÁöÑ", type: "ÂΩ¢ÂÆπËØç" },
            { french: "petit", chinese: "Â∞èÁöÑ", type: "ÂΩ¢ÂÆπËØç" },
            { french: "bon", chinese: "Â•ΩÁöÑ", type: "ÂΩ¢ÂÆπËØç" },
            { french: "mauvais", chinese: "ÂùèÁöÑ", type: "ÂΩ¢ÂÆπËØç" },
            { french: "nouveau", chinese: "Êñ∞ÁöÑ", type: "ÂΩ¢ÂÆπËØç" },
            { french: "vieux", chinese: "ËÄÅÁöÑ", type: "ÂΩ¢ÂÆπËØç" },
            { french: "jeune", chinese: "Âπ¥ËΩªÁöÑ", type: "ÂΩ¢ÂÆπËØç" },
            { french: "content", chinese: "ÂºÄÂøÉÁöÑ", type: "ÂΩ¢ÂÆπËØç" },
            { french: "triste", chinese: "ÊÇ≤‰º§ÁöÑ", type: "ÂΩ¢ÂÆπËØç" },
            { french: "fatigu√©", chinese: "Áñ≤ÂÄ¶ÁöÑ", type: "ÂΩ¢ÂÆπËØç" },
            { french: "chaud", chinese: "ÁÉ≠ÁöÑ", type: "ÂΩ¢ÂÆπËØç" },
            { french: "froid", chinese: "ÂÜ∑ÁöÑ", type: "ÂΩ¢ÂÆπËØç" },
            { french: "rouge", chinese: "Á∫¢Ëâ≤", type: "È¢úËâ≤" },
            { french: "bleu", chinese: "ËìùËâ≤", type: "È¢úËâ≤" },
            { french: "vert", chinese: "ÁªøËâ≤", type: "È¢úËâ≤" },
            { french: "jaune", chinese: "ÈªÑËâ≤", type: "È¢úËâ≤" },
            { french: "noir", chinese: "ÈªëËâ≤", type: "È¢úËâ≤" },
            { french: "blanc", chinese: "ÁôΩËâ≤", type: "È¢úËâ≤" },
            { french: "rose", chinese: "Á≤âËâ≤", type: "È¢úËâ≤" },
            { french: "orange", chinese: "Ê©ôËâ≤", type: "È¢úËâ≤" },
            { french: "violet", chinese: "Á¥´Ëâ≤", type: "È¢úËâ≤" },
            { french: "un", chinese: "‰∏Ä(Èò≥ÊÄß)", type: "Êï∞Â≠ó" },
            { french: "deux", chinese: "‰∫å", type: "Êï∞Â≠ó" },
            { french: "trois", chinese: "‰∏â", type: "Êï∞Â≠ó" },
            { french: "quatre", chinese: "Âõõ", type: "Êï∞Â≠ó" },
            { french: "cinq", chinese: "‰∫î", type: "Êï∞Â≠ó" },
            { french: "six", chinese: "ÂÖ≠", type: "Êï∞Â≠ó" },
            { french: "sept", chinese: "‰∏É", type: "Êï∞Â≠ó" },
            { french: "huit", chinese: "ÂÖ´", type: "Êï∞Â≠ó" },
            { french: "neuf", chinese: "‰πù", type: "Êï∞Â≠ó" },
            { french: "dix", chinese: "ÂçÅ", type: "Êï∞Â≠ó" }
        ];

        const sentences = [
            { french: "Je m'appelle Marie.", chinese: "ÊàëÂè´Áéõ‰∏Ω„ÄÇ" },
            { french: "Comment allez-vous?", chinese: "ÊÇ®Â•ΩÂêóÔºü" },
            { french: "√áa va bien, merci.", chinese: "ÊàëÂæàÂ•ΩÔºåË∞¢Ë∞¢„ÄÇ" },
            { french: "Je suis √©tudiant.", chinese: "ÊàëÊòØÂ≠¶Áîü„ÄÇ" },
            { french: "J'habite √† Paris.", chinese: "Êàë‰ΩèÂú®Â∑¥Èªé„ÄÇ" },
            { french: "Je parle fran√ßais.", chinese: "ÊàëËØ¥Ê≥ïËØ≠„ÄÇ" },
            { french: "Quelle heure est-il?", chinese: "Âá†ÁÇπ‰∫ÜÔºü" },
            { french: "Il est trois heures.", chinese: "‰∏âÁÇπ‰∫Ü„ÄÇ" },
            { french: "J'aime le chocolat.", chinese: "ÊàëÂñúÊ¨¢Â∑ßÂÖãÂäõ„ÄÇ" },
            { french: "Je voudrais un caf√©.", chinese: "ÊàëÊÉ≥Ë¶Å‰∏ÄÊùØÂíñÂï°„ÄÇ" }
        ];

        // Áä∂ÊÄÅ
        let currentMode = 'word';
        let currentIndex = 0;
        let mastered = new Set();
        let alterEgo = {
            name: '',
            level: 1,
            points: 0
        };

        // DOM ÂÖÉÁ¥†
        const setupScreen = document.getElementById('setupScreen');
        const mainApp = document.getElementById('mainApp');
        const nameInput = document.getElementById('nameInput');
        const startButton = document.getElementById('startButton');
        const avatar = document.getElementById('avatar');
        const userName = document.getElementById('userName');
        const userLevel = document.getElementById('userLevel');
        const userPoints = document.getElementById('userPoints');
        const masteredCount = document.getElementById('masteredCount');
        const progressFill = document.getElementById('progressFill');
        const wordMode = document.getElementById('wordMode');
        const sentenceMode = document.getElementById('sentenceMode');
        const card = document.getElementById('card');
        const wordType = document.getElementById('wordType');
        const frontText = document.getElementById('frontText');
        const backText = document.getElementById('backText');
        const masteredBadge = document.getElementById('masteredBadge');
        const prevButton = document.getElementById('prevButton');
        const nextButton = document.getElementById('nextButton');
        const masterButton = document.getElementById('masterButton');
        const currentIndexEl = document.getElementById('currentIndex');
        const totalCards = document.getElementById('totalCards');

        // ËÆæÁΩÆÈ°µÈù¢ÈÄªËæë
        nameInput.addEventListener('input', (e) => {
            startButton.disabled = !e.target.value.trim();
        });

        nameInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && nameInput.value.trim()) {
                startApp();
            }
        });

        startButton.addEventListener('click', startApp);

        function startApp() {
            alterEgo.name = nameInput.value.trim();
            avatar.textContent = alterEgo.name[0].toUpperCase();
            userName.textContent = alterEgo.name;
            setupScreen.classList.add('hidden');
            mainApp.style.display = 'block';
            updateCard();
        }

        // Ê®°ÂºèÂàáÊç¢
        wordMode.addEventListener('click', () => {
            if (currentMode !== 'word') {
                currentMode = 'word';
                currentIndex = 0;
                wordMode.classList.add('active');
                sentenceMode.classList.remove('active');
                card.classList.remove('flipped');
                updateCard();
            }
        });

        sentenceMode.addEventListener('click', () => {
            if (currentMode !== 'sentence') {
                currentMode = 'sentence';
                currentIndex = 0;
                sentenceMode.classList.add('active');
                wordMode.classList.remove('active');
                card.classList.remove('flipped');
                updateCard();
            }
        });

        // Âç°ÁâáÁøªËΩ¨
        card.addEventListener('click', () => {
            card.classList.toggle('flipped');
        });

        // ÂØºËà™ÊåâÈíÆ
        prevButton.addEventListener('click', () => {
            const data = currentMode === 'word' ? words : sentences;
            currentIndex = (currentIndex - 1 + data.length) % data.length;
            card.classList.remove('flipped');
            updateCard();
        });

        nextButton.addEventListener('click', () => {
            const data = currentMode === 'word' ? words : sentences;
            currentIndex = (currentIndex + 1) % data.length;
            card.classList.remove('flipped');
            updateCard();
        });

        // ÊéåÊè°ÊåâÈíÆ
        masterButton.addEventListener('click', () => {
            const key = `${currentMode}-${currentIndex}`;
            if (mastered.has(key)) {
                mastered.delete(key);
                alterEgo.points = Math.max(0, alterEgo.points - 10);
            } else {
                mastered.add(key);
                alterEgo.points += 10;
            }
            alterEgo.level = Math.floor(alterEgo.points / 100) + 1;
            updateUI();
        });

        // Êõ¥Êñ∞Âç°Áâá
        function updateCard() {
            const data = currentMode === 'word' ? words : sentences;
            const item = data[currentIndex];
            
            frontText.textContent = item.french;
            backText.textContent = item.chinese;
            
            if (currentMode === 'word') {
                wordType.textContent = item.type;
                wordType.style.display = 'inline-block';
            } else {
                wordType.style.display = 'none';
            }

            const key = `${currentMode}-${currentIndex}`;
            const isMastered = mastered.has(key);
            
            if (isMastered) {
                masteredBadge.classList.remove('hidden');
                masterButton.classList.add('mastered');
                masterButton.textContent = '‚úì Â∑≤ÊéåÊè°';
            } else {
                masteredBadge.classList.add('hidden');
                masterButton.classList.remove('mastered');
                masterButton.textContent = 'Ê†áËÆ∞‰∏∫Â∑≤ÊéåÊè°';
            }

            currentIndexEl.textContent = currentIndex + 1;
            totalCards.textContent = data.length;
        }

        // Êõ¥Êñ∞UI
        function updateUI() {
            userLevel.textContent = alterEgo.level;
            userPoints.textContent = alterEgo.points;
            masteredCount.textContent = mastered.size;
            
            const totalItems = words.length + sentences.length;
            const progress = (mastered.size / totalItems) * 100;
            progressFill.style.width = progress + '%';
            
            updateCard();
        }

        // ÈîÆÁõòÂø´Êç∑ÈîÆ
        document.addEventListener('keydown', (e) => {
            if (setupScreen.classList.contains('hidden')) {
                if (e.key === 'ArrowLeft') prevButton.click();
                if (e.key === 'ArrowRight') nextButton.click();
                if (e.key === ' ') {
                    e.preventDefault();
                    card.classList.toggle('flipped');
                }
                if (e.key === 'Enter') masterButton.click();
            }
        });
    </script>
</body>
</html>
